<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Business Portal ‚Äî Login-first (Light + Dark Glass)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { darkMode: 'class' }</script>
  <style>
    :root{ --accent:#2563eb; --sidebar:#0f1724; }
    html,body,#app{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#f5f7fb;color:#0b1220;-webkit-font-smoothing:antialiased;}
    /* hidden until login */
    .hidden-until-login{ display:none !important; }
    /* login covering screen */
    #loginWrapper{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:80; padding:20px; transition:opacity .22s ease; }
    /* light login card */
    .login-card { width:100%; max-width:520px; border-radius:12px; background: #ffffff; box-shadow: 0 12px 40px rgba(11,17,32,0.06); padding:22px; }
    .login-card h2{ margin:0 0 8px 0; font-size:1.25rem; }
    .muted{ color:#6b7280; font-size:.95rem; }

    /* dark glass mode styles */
    body.darkglass { background: linear-gradient(180deg,#061022,#071428); color:#e6eef8; }
    .glass-card { width:100%; max-width:520px; border-radius:14px; padding:22px; background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.06); backdrop-filter: blur(6px) saturate(120%); box-shadow: 0 12px 40px rgba(2,6,23,0.6); color:#e6eef8; }
    .glass-card input::placeholder { color: rgba(255,255,255,0.6); }

    /* background image toggle */
    #bgImage { position:fixed; inset:0; background-image:url('https://images.unsplash.com/photo-1509223197845-458d87318791?q=80&w=1600&auto=format&fit=crop&ixlib=rb-4.0.3&s=1c4f8b4b3f1d2d9bfb87c0e5f3d2b7a9'); background-size:cover; background-position:center; filter: blur(6px) brightness(.6); z-index:10; display:none; }

    /* topbar, sidebar, content */
    .app { display:flex; min-height:100vh; }
    .sidebar { width:260px; background:var(--sidebar); color:#dbefff; display:flex; flex-direction:column; padding:16px; gap:12px; }
    .main { flex:1; display:flex; flex-direction:column; }
    header.topbar{ height:64px; display:flex; align-items:center; justify-content:space-between; padding:10px 18px; background:transparent; border-bottom:1px solid rgba(11,17,32,0.04); }
    .searchbox{ min-width:220px; padding:8px 12px; border-radius:10px; border:1px solid rgba(11,17,32,0.05); }
    .profile-pill{ display:flex; align-items:center; gap:10px; padding:6px 8px; border-radius:999px; background:linear-gradient(180deg, rgba(0,0,0,0.03), rgba(255,255,255,0.02)); cursor:pointer; }
    .avatar{ width:38px; height:38px; border-radius:50%; object-fit:cover; border:2px solid #fff; }

    /* profile dropdown */
    #profileMenu { position:absolute; right:18px; top:70px; min-width:220px; background:white; color:#0b1220; border-radius:12px; padding-top:6px; z-index:120; opacity:0; transform:translateY(-6px); transition:opacity .18s ease, transform .18s ease; pointer-events:none; box-shadow: 0 10px 30px rgba(2,6,23,0.12); }
    #profileMenu.open{ opacity:1; transform:translateY(0); pointer-events:auto; }
    #profileMenu::before { content:''; position:absolute; top:-8px; right:20px; border-width:8px; border-style:solid; border-color:transparent transparent white transparent; }
    #profileMenu.flip-up::before{ top:auto; bottom:-16px; border-color:white transparent transparent transparent; }

    #dropdownOverlay{ position:fixed; inset:0; background:rgba(0,0,0,0.24); backdrop-filter: blur(2px); opacity:0; transition:opacity .18s ease; pointer-events:none; z-index:110; }
    #dropdownOverlay.active{ opacity:1; pointer-events:all; }

    @media (max-width:900px){
      .sidebar{ position:fixed; left:0; top:0; height:100%; transform:translateX(-100%); transition:transform .24s ease; z-index:90; }
      .sidebar.open{ transform:translateX(0); }
      .profile-pill .name{ display:none; }
    }
  </style>
</head>
<body>

  <!-- optional bg image for dark glass -->
  <div id="bgImage"></div>

  <!-- overlay for dropdown focus -->
  <div id="dropdownOverlay"></div>

  <div id="app" class="app">
    <!-- SIDEBAR (hidden until login) -->
    <aside id="sidebar" class="sidebar hidden-until-login">
      <div class="brand flex items-center gap-3">
        <div class="w-12 h-12 rounded-lg bg-gradient-to-br from-sky-400 to-sky-600 flex items-center justify-center font-bold">BP</div>
        <div>
          <div class="text-sm font-semibold">Business Portal</div>
          <div class="text-xs text-sky-200">Admin Dashboard</div>
        </div>
      </div>
      <nav id="navList" class="flex-1 overflow-auto">
        <div class="text-sky-300 text-xs mb-2">General</div>
        <button data-page="home" class="nav-item w-full text-left flex items-center gap-3 px-3 py-2 rounded-md hover:bg-white/5">üè† <span class="ml-2">Home</span></button>
        <div class="text-sky-300 text-xs mt-4 mb-1">Inventory</div>
        <button data-page="goods-panel" class="nav-item px-3 py-2 rounded-md hover:bg-white/5">üì¶ <span class="ml-2">Goods Panel</span></button>
        <button data-page="goodsin" class="nav-item px-3 py-2 rounded-md hover:bg-white/5">‚¨ÜÔ∏è <span class="ml-2">Goods In</span></button>
        <button data-page="goodsout" class="nav-item px-3 py-2 rounded-md hover:bg-white/5">‚¨áÔ∏è <span class="ml-2">Goods Out</span></button>
        <div class="text-sky-300 text-xs mt-4 mb-1">Users</div>
        <button data-page="user-management" class="nav-item px-3 py-2 rounded-md hover:bg-white/5">üë• <span class="ml-2">User Management</span></button>
        <div class="text-sky-300 text-xs mt-4 mb-1">System</div>
        <button data-page="settings" class="nav-item px-3 py-2 rounded-md hover:bg-white/5">‚öôÔ∏è <span class="ml-2">Settings</span></button>
      </nav>
      <div class="mt-auto">
        <button id="collapseBtn" class="w-full bg-white/6 text-sm py-2 rounded-md">Collapse</button>
      </div>
    </aside>

    <!-- MAIN -->
    <div class="main">
      <header id="topbar" class="topbar hidden-until-login">
        <div class="top-left flex items-center gap-3">
          <button id="mobileMenuBtn" class="md:hidden p-2 rounded-md hover:bg-white/5">‚ò∞</button>
          <div class="title font-semibold">Dashboard</div>
          <div class="ml-4 hidden md:block"><input id="globalSearch" class="searchbox" placeholder="Search goods, users, movements..." /></div>
        </div>
        <div class="top-actions flex items-center gap-3 relative">
          <button id="themeToggleTop" class="p-2 rounded-md hover:bg-white/5" title="Toggle theme on top">üåô</button>
          <div id="profileBtn" class="profile-pill">
            <img id="avatarImg" class="avatar" src="https://i.pravatar.cc/150?img=10" alt="avatar" />
            <div class="name">
              <div id="headerName" class="font-semibold text-sm">Guest</div>
              <div class="text-xs muted">Administrator</div>
            </div>
          </div>

          <div id="profileMenu" class="hidden">
            <a data-page="profiles" class="flex items-center gap-2 px-4 py-2 hover:bg-gray-50 cursor-pointer">üë§ Profile</a>
            <a data-page="settings" class="flex items-center gap-2 px-4 py-2 hover:bg-gray-50 cursor-pointer">‚öôÔ∏è Settings</a>
            <div class="my-1 border-t"></div>
            <div class="px-4 py-2"><label class="flex items-center gap-2"><input id="themeToggleDropdown" type="checkbox" /> Dark glass</label></div>
            <div class="my-1 border-t"></div>
            <button id="logoutTop" class="w-full text-left px-4 py-2 hover:bg-red-50 text-red-600">Logout</button>
          </div>
        </div>
      </header>

      <main id="content" class="p-6 overflow-auto hidden-until-login"></main>
      <footer id="footer" class="border-t py-3 px-6 text-xs muted hidden-until-login">&copy; <span id="year"></span> Business Portal ‚Äî Demo</footer>
    </div>
  </div>

  <!-- LOGIN WRAPPER (covers everything until login) -->
  <div id="loginWrapper">
    <!-- Light card by default; dark glass when toggled -->
    <div id="loginCard" class="login-card">
      <div class="flex items-center justify-between mb-4">
        <div>
          <h2>Sign in to Business Portal</h2>
          <div class="muted">Use a local account. Create accounts in User Management.</div>
        </div>
        <div class="flex items-center gap-2">
          <!-- theme toggle on login top-right -->
          <label class="text-sm muted inline-flex items-center gap-2">
            <input id="loginThemeToggle" type="checkbox" /> Dark glass
          </label>
          <button id="useImageBg" class="text-sm muted px-2 py-1 rounded hover:bg-gray-50">Image BG</button>
        </div>
      </div>

      <form id="loginFrm">
        <div class="mb-2"><label class="text-sm muted">Username</label><input id="li_user" class="w-full mt-1 px-3 py-2 rounded-md border placeholder:muted" placeholder="username" /></div>
        <div class="mb-3"><label class="text-sm muted">Password</label><input id="li_pass" type="password" class="w-full mt-1 px-3 py-2 rounded-md border placeholder:muted" placeholder="password" /></div>
        <div class="flex items-center gap-2">
          <button class="px-4 py-2 rounded-md bg-accent text-white" type="submit">Login</button>
          <button id="loginDemoBtn" type="button" class="px-4 py-2 rounded-md border">Auto Login (admin)</button>
          <button id="showRegister" type="button" class="ml-auto px-3 py-2 text-sm muted rounded-md hover:bg-white/5">Register</button>
        </div>
        <div id="loginMsg" class="text-sm text-red-500 mt-2 hidden"></div>
      </form>

      <div id="registerPanel" class="mt-4 border-t pt-4 hidden">
        <h3 class="font-semibold">Create local account</h3>
        <p class="muted text-sm mb-3">Create a user saved to LocalStorage (demo).</p>
        <form id="registerFrm">
          <div class="mb-2"><label class="text-sm muted">Username</label><input id="reg_user" class="w-full px-3 py-2 rounded-md border" /></div>
          <div class="mb-2"><label class="text-sm muted">Password</label><input id="reg_pass" type="password" class="w-full px-3 py-2 rounded-md border" /></div>
          <div class="mb-3"><label class="text-sm muted">Role</label><select id="reg_role" class="w-full px-3 py-2 rounded-md border"><option value="user">user</option><option value="admin">admin</option></select></div>
          <div class="flex gap-2"><button class="px-3 py-2 rounded-md bg-accent text-white" type="submit">Create</button><button id="cancelRegister" type="button" class="px-3 py-2 rounded-md border">Cancel</button></div>
          <div id="regMsg" class="text-sm text-red-600 hidden"></div>
        </form>
      </div>
    </div>
  </div>

<script>
/* Persistence helpers */
const storage = {
  get(k,f){ try{ const v=localStorage.getItem(k); return v?JSON.parse(v):f }catch(e){return f} },
  set(k,v){ localStorage.setItem(k, JSON.stringify(v)) },
  rm(k){ localStorage.removeItem(k) }
};
const KEYS = { USERS:'bp_users', GOODS:'bp_goods', MOVES:'bp_moves', INVITES:'bp_invites', STEMPL:'bp_stempl', PROFILE:'bp_profile', SETTINGS:'bp_settings', CONTACTS:'bp_contacts' };

/* Ensure defaults */
function ensureDefaults(){
  if(!storage.get(KEYS.USERS)){
    storage.set(KEYS.USERS, [
      { id:'u_admin', username:'admin', password:'admin123', role:'admin', email:'admin@example.com' },
      { id:'u_user', username:'user', password:'user123', role:'user', email:'user@example.com' }
    ]);
  } else {
    // ensure password field exists for older exports
    const users = storage.get(KEYS.USERS,[]); let changed=false;
    for(const u of users){ if(!('password' in u)){ u.password='1234'; changed=true } }
    if(changed) storage.set(KEYS.USERS, users);
  }
  if(!storage.get(KEYS.GOODS)) storage.set(KEYS.GOODS, [{id:'g1', sku:'SKU-001', name:'Widget A', qty:12},{id:'g2', sku:'SKU-002', name:'Gadget B', qty:4}]);
  if(!storage.get(KEYS.MOVES)) storage.set(KEYS.MOVES, []);
  if(!storage.get(KEYS.INVITES)) storage.set(KEYS.INVITES, []);
  if(!storage.get(KEYS.STEMPL)) storage.set(KEYS.STEMPL, []);
  if(!storage.get(KEYS.SETTINGS)) storage.set(KEYS.SETTINGS, {dark:false, notifications:true, emailUpdates:true});
  if(!storage.get(KEYS.CONTACTS)) storage.set(KEYS.CONTACTS, []);
  if(!storage.get(KEYS.PROFILE)) storage.set(KEYS.PROFILE, {name:'Guest', email:'', avatar:''});
}
ensureDefaults();

/* DOM refs */
const loginWrapper = document.getElementById('loginWrapper'), loginCard = document.getElementById('loginCard'),
      loginFrm = document.getElementById('loginFrm'), loginMsg = document.getElementById('loginMsg'),
      loginDemoBtn = document.getElementById('loginDemoBtn'), showRegister = document.getElementById('showRegister'),
      registerPanel = document.getElementById('registerPanel'), registerFrm = document.getElementById('registerFrm'),
      cancelRegister = document.getElementById('cancelRegister'), regMsg = document.getElementById('regMsg'),
      loginThemeToggle = document.getElementById('loginThemeToggle'), bgImage = document.getElementById('bgImage'),
      useImageBg = document.getElementById('useImageBg'),
      sidebar = document.getElementById('sidebar'), topbar = document.getElementById('topbar'),
      content = document.getElementById('content'), footer = document.getElementById('footer'),
      profileBtn = document.getElementById('profileBtn'), profileMenu = document.getElementById('profileMenu'),
      headerName = document.getElementById('headerName'), avatarImg = document.getElementById('avatarImg'),
      logoutTop = document.getElementById('logoutTop'), dropdownOverlay = document.getElementById('dropdownOverlay'),
      navList = document.getElementById('navList'), yearEl = document.getElementById('year'),
      themeToggleTop = document.getElementById('themeToggleTop'), themeToggleDropdown = document.getElementById('themeToggleDropdown'),
      mobileMenuBtn = document.getElementById('mobileMenuBtn'), collapseBtn = document.getElementById('collapseBtn'),
      globalSearch = document.getElementById('globalSearch');
yearEl.textContent = new Date().getFullYear();

/* session helpers */
function currentUser(){ return JSON.parse(localStorage.getItem('bp_current_user') || 'null') }
function setCurrentUserObj(userObj){ localStorage.setItem('bp_current_user', JSON.stringify(userObj)); headerName.textContent = userObj.displayName || userObj.username; applyRolePermissions(userObj.role); renderLoginVisible(false); navigate('home'); setActiveNavButton(document.querySelector('[data-page=\"home\"]')); }

/* Show/hide login & dashboard */
function renderLoginVisible(showLogin){
  const dashboardEls = [sidebar, topbar, content, footer];
  if(showLogin){
    dashboardEls.forEach(el=>{ if(!el) return; el.classList.add('hidden-until-login'); });
    loginWrapper.style.display = 'flex';
    // reset profile menu/overlay
    profileMenu.classList.remove('open');
    dropdownOverlay.classList.remove('active');
  } else {
    loginWrapper.style.display = 'none';
    dashboardEls.forEach(el=>{ if(!el) return; el.classList.remove('hidden-until-login'); });
  }
}

/* find user by username */
function findUserByUsername(username){ const users = storage.get(KEYS.USERS,[]); return users.find(u => u.username && u.username.toLowerCase() === username.toLowerCase()) || null; }

/* Login form */
loginFrm.addEventListener('submit', e=>{
  e.preventDefault();
  const username = document.getElementById('li_user').value.trim();
  const password = document.getElementById('li_pass').value;
  const user = findUserByUsername(username);
  if(!user || user.password !== password){
    loginMsg.textContent = 'Invalid username or password';
    loginMsg.classList.remove('hidden');
    return;
  }
  loginMsg.classList.add('hidden');
  const profile = storage.get(KEYS.PROFILE,{});
  const displayName = profile.name || user.username;
  setCurrentUserObj({ username: user.username, role: user.role, displayName });
  if(profile.avatar) avatarImg.src = profile.avatar;
});

/* Demo login */
loginDemoBtn.addEventListener('click', ()=>{
  const user = findUserByUsername('admin');
  if(!user){ alert('No admin user found'); return; }
  setCurrentUserObj({ username: user.username, role: user.role, displayName: user.username });
});

/* register handlers */
showRegister.addEventListener('click', ()=>{ registerPanel.classList.toggle('hidden'); regMsg.classList.add('hidden'); });
cancelRegister.addEventListener('click', ()=> registerPanel.classList.add('hidden'));
registerFrm.addEventListener('submit', e=>{
  e.preventDefault();
  const username = document.getElementById('reg_user').value.trim();
  const password = document.getElementById('reg_pass').value;
  const role = document.getElementById('reg_role').value || 'user';
  if(!username || !password){ regMsg.textContent = 'Username and password required'; regMsg.classList.remove('hidden'); return; }
  if(findUserByUsername(username)){ regMsg.textContent = 'Username already exists'; regMsg.classList.remove('hidden'); return; }
  const users = storage.get(KEYS.USERS,[]);
  users.push({ id:'u'+Date.now(), username, password, role, email:''});
  storage.set(KEYS.USERS, users);
  regMsg.textContent = 'User created ‚Äî you can now log in';
  regMsg.classList.remove('hidden');
  registerFrm.reset();
  registerPanel.classList.add('hidden');
});

/* logout */
logoutTop.addEventListener('click', ()=>{ localStorage.removeItem('bp_current_user'); renderLoginVisible(true); });

/* Nav wiring */
navList.querySelectorAll('button[data-page]').forEach(btn=>{ btn.addEventListener('click', ()=> { setActiveNavButton(btn); navigate(btn.dataset.page); if(window.innerWidth < 900) sidebar.classList.add('open'); }); });
function setActiveNavButton(btn){ navList.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('bg-white/5','font-semibold')); if(btn) btn.classList.add('bg-white/5','font-semibold'); }

/* collapse & mobile */
collapseBtn.addEventListener('click', ()=>{ if(sidebar.classList.contains('sidebar-collapsed')) { sidebar.classList.remove('sidebar-collapsed'); collapseBtn.textContent='Collapse'; } else { sidebar.classList.add('sidebar-collapsed'); collapseBtn.textContent='Expand'; } });
mobileMenuBtn.addEventListener('click', ()=> sidebar.classList.toggle('open'));

/* profile dropdown with flip + overlay */
profileBtn.addEventListener('click', (e)=>{
  e.stopPropagation();
  const rectBtn = profileBtn.getBoundingClientRect();
  const belowSpace = window.innerHeight - rectBtn.bottom;
  if(belowSpace < 140){
    profileMenu.classList.add('flip-up');
    profileMenu.style.top = 'auto';
    profileMenu.style.bottom = (window.innerHeight - rectBtn.top + 8) + 'px';
  } else {
    profileMenu.classList.remove('flip-up');
    profileMenu.style.bottom = 'auto';
    profileMenu.style.top = (rectBtn.bottom + 6) + 'px';
  }
  profileMenu.classList.toggle('open');
  dropdownOverlay.classList.toggle('active', profileMenu.classList.contains('open'));
});
document.addEventListener('click', (e)=>{ if(!profileMenu.contains(e.target) && !profileBtn.contains(e.target)){ profileMenu.classList.remove('open'); dropdownOverlay.classList.remove('active'); } });

/* theme toggles: login checkbox and dropdown checkbox + top */
loginThemeToggle.addEventListener('change', (e)=>{
  if(loginThemeToggle.checked){
    document.body.classList.add('darkglass');
  } else {
    document.body.classList.remove('darkglass');
    bgImage.style.display = 'none';
  }
  // sync dropdown checkbox later when shown
  themeToggleDropdown.checked = loginThemeToggle.checked;
});
themeToggleTop.addEventListener('click', ()=>{ document.body.classList.toggle('darkglass'); loginThemeToggle.checked = document.body.classList.contains('darkglass'); themeToggleDropdown.checked = loginThemeToggle.checked; });
themeToggleDropdown.addEventListener('change', ()=>{ document.body.classList.toggle('darkglass'); loginThemeToggle.checked = document.body.classList.contains('darkglass'); });

useImageBg.addEventListener('click', ()=>{
  if(bgImage.style.display === 'block'){ bgImage.style.display = 'none'; useImageBg.textContent = 'Image BG'; }
  else { bgImage.style.display = 'block'; useImageBg.textContent = 'Image BG (on)'; document.body.classList.add('darkglass'); loginThemeToggle.checked = true; themeToggleDropdown.checked = true; }
});

/* Global search */
globalSearch.addEventListener('input', ()=>{ const q = globalSearch.value.trim().toLowerCase(); if(!q) return setActiveNavButton(document.querySelector('[data-page=\"home\"]')), navigate('home'); renderQuickSearch(q); });

/* Apply role visibility */
function applyRolePermissions(role){ const devNav = document.getElementById('nav-developer'); const userMgmtBtn = Array.from(navList.querySelectorAll('[data-page=\"user-management\"]'))[0]; const inviteBtn = Array.from(navList.querySelectorAll('[data-page=\"admin-invite-history\"]'))[0]; if(role === 'admin'){ if(devNav) devNav.style.display=''; if(userMgmtBtn) userMgmtBtn.style.display=''; if(inviteBtn) inviteBtn.style.display=''; } else { if(devNav) devNav.style.display='none'; if(userMgmtBtn) userMgmtBtn.style.display='none'; if(inviteBtn) inviteBtn.style.display='none'; } }

/* Router (minimal renderers for demo) */
function navigate(page){ switch(page){ case 'home': return renderHome(); case 'goods-panel': return renderGoodsPanel(); case 'goodsin': return renderGoodsIn(); case 'goodsout': return renderGoodsOut(); case 'profiles': return renderProfiles(); case 'user-management': return renderUserManagement(); case 'settings': return renderSettings(); default: renderHome(); } }

function renderHome(){ const goods = storage.get(KEYS.GOODS,[]), moves = storage.get(KEYS.MOVES,[]).slice(-6).reverse(); const users = storage.get(KEYS.USERS,[]); const cur = currentUser(); content.innerHTML = `<div class=\"grid grid-cols-1 lg:grid-cols-3 gap-4\"><div class=\"col-span-2\"><div class=\"bg-white rounded-2xl p-5 text-slate-900\"><div class=\"flex items-start justify-between\"><div><h2 class=\"text-xl font-semibold\">Welcome, ${escapeHtml(cur?.displayName || cur?.username || 'Guest')} üëã</h2><p class=\"text-sm text-slate-500\">Overview of your operations</p></div><div class=\"text-sm text-slate-400\">${new Date().toLocaleString()}</div></div><div class=\"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3\"><div class=\"p-4 rounded-lg bg-slate-50\"><div class=\"text-xs text-slate-400\">Items</div><div class=\"text-lg font-semibold\">${goods.length}</div><div class=\"text-sm text-slate-500 mt-1\">${goods.reduce((s,g)=>s+(g.qty||0),0)} total qty</div></div><div class=\"p-4 rounded-lg bg-slate-50\"><div class=\"text-xs text-slate-400\">Movements</div><div class=\"text-lg font-semibold\">${storage.get(KEYS.MOVES,[]).length}</div></div><div class=\"p-4 rounded-lg bg-slate-50\"><div class=\"text-xs text-slate-400\">Users</div><div class=\"text-lg font-semibold\">${users.length}</div></div></div><div class=\"mt-4\"><h3 class=\"text-sm font-semibold mb-2\">Recent Movements</h3><div class=\"space-y-2\">${moves.length ? moves.map(m=>`<div class=\"p-3 bg-white/50 rounded-md flex justify-between items-center text-sm\"><div><strong>${m.type}</strong> &nbsp; ${escapeHtml(m.name)} <span class=\"text-slate-400\">(${m.qty})</span></div><div class=\"text-slate-400 text-xs\">${new Date(m.ts).toLocaleString()}</div></div>`).join('') : '<div class=\"text-slate-400\">No movements</div>'}</div></div></div></div><aside><div class=\"bg-white rounded-2xl p-4\"><h4 class=\"font-semibold\">Quick Actions</h4><div class=\"mt-3 grid gap-2\"><button class=\"py-2 px-3 rounded-md bg-[#2563eb] text-white\" onclick=\"navigate('goodsin')\">Record Goods In</button><button class=\"py-2 px-3 rounded-md border\" onclick=\"navigate('goodsout')\">Record Goods Out</button><button class=\"py-2 px-3 rounded-md border\" onclick=\"navigate('goods-panel')\">Open Goods Panel</button></div></div></aside></div>`; }

function renderGoodsPanel(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">Goods Panel ‚Äî full features in downloadable file.</div>`; }
function renderGoodsIn(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">Goods In ‚Äî full features in downloadable file.</div>`; }
function renderGoodsOut(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">Goods Out ‚Äî full features in downloadable file.</div>`; }
function renderProfiles(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">Profile editor ‚Äî full features in downloadable file.</div>`; }
function renderUserManagement(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">User Management ‚Äî full features in downloadable file.</div>`; }
function renderSettings(){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\">Settings ‚Äî full features in downloadable file.</div>`; }

/* quick search placeholder */
function renderQuickSearch(q){ content.innerHTML = `<div class=\"bg-white rounded-2xl p-5 text-slate-900\"><h2>Search: ${escapeHtml(q)}</h2></div>`; }

/* util */
function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }

/* restore session */
(function restoreSession(){ const cur = currentUser(); if(cur){ const profile = storage.get(KEYS.PROFILE,{}); headerName.textContent = profile.name || cur.username; if(profile.avatar) avatarImg.src = profile.avatar; applyRolePermissions(cur.role); renderLoginVisible(false); navigate('home'); setActiveNavButton(document.querySelector('[data-page=\"home\"]')); } else { renderLoginVisible(true); } })();

</script>
</body>
</html>
